var marqdoujAzureMaps;(()=>{"use strict";var e={d:(t,a)=>{for(var s in a)e.o(a,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:a[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Configuration:()=>B,Layers:()=>H,MapFactory:()=>G,Maps:()=>W});const a=atlas;var s,o,n,r,i,l,d,c,p,u,v,g,h,y,E,M,m,f,I;!function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warn=3]="Warn",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None"}(s||(s={}));class b{static currentLevel=s.Information;static GetMapHeader(e){return`Map with Id '${e}'`}static logMessage(e,t,a,...o){if(t<this.currentLevel)return;const n=`${this.GetMapHeader(e)} ${a}`;switch(t){case s.Trace:console.trace(n,...o);break;case s.Debug:console.debug(n,...o);break;case s.Information:console.info(n,...o);break;case s.Warn:console.warn(n,...o);break;case s.Error:console.error(n,...o);break;case s.Critical:console.error(`CRITICAL: ${n}`,...o)}}}class C{static isEmptyOrNull(e){return null==e||""===e.trim()}static isNotEmptyOrNull(e){return!this.isEmptyOrNull(e)}static isValueInEnum(e,t){return Object.values(e).includes(t)}static isFeature(e){return e&&"Feature"===e.type}static isShape(e){return e&&null!=e.getType}static getFeatureResult(e){return{jsInterop:this.getJsInterop(e),id:e.id?.toString(),type:e.geometry.type,bbox:e.bbox,source:"feature",properties:e.properties}}static getShapeResult(e){return{jsInterop:this.getJsInterop(e),id:e.getId()?.toString(),type:e.getType(),bbox:e.getBounds(),source:"shape",properties:e.getProperties()}}static buildEventResult(e,t,a){return{mapId:e,type:t.type,target:t.target,payload:{targetId:t.targetId,...a}}}static buildShapeResults(e){const t=[];return e.filter(e=>this.isFeature(e)).forEach(e=>{t.push(this.getFeatureResult(e))}),e.filter(e=>this.isShape(e)).forEach(e=>{t.push(this.getShapeResult(e))}),t}static buildLayerPayload(e){return{id:e.getId(),jsInterop:C.getJsInterop(e)}}static buildDataSourcePayload(e){return{id:e.getId(),jsInterop:C.getJsInterop(e)}}static buildMouseEventPayload(e){return{mouse:{layerId:e.layerId,pixel:e.pixel,position:e.position,shapes:this.buildShapeResults(e.shapes)}}}static buildTargetedEventPayload(e){return{jsInterop:e.target.jsInterop,type:e.type}}static buildTouchEventPayload(e){return{pixel:e.pixel,pixels:e.pixels,position:e.position,positions:e.positions,layerId:e.layerId,shapes:this.buildShapeResults(e.shapes)}}static buildWheelEventPayload(e){return{type:e.type}}static isJsInteropDef(e){return e&&null!=e.jsInterop&&null!=e.jsInterop.interopId}static isInteropControl(e,t){let a=this.isJsInteropDef(e);return a&&C.isNotEmptyOrNull(t)&&(a=e.jsInterop.id===t||e.jsInterop.interopId===t),a}static isInteropLayer(e,t){let a=this.isJsInteropDef(e);return a&&C.isNotEmptyOrNull(t)&&(a=e.jsInterop.id===t||e.jsInterop.interopId===t),a}static getJsInterop(e){if(this.isJsInteropDef(e))return e.jsInterop}}class k{static add(e,t){const o=G.getMap(e);o&&t.forEach(t=>{let n=null;switch(t.type.toLowerCase()){case"compass":n=new a.control.CompassControl(t.options);break;case"fullscreen":n=new a.control.FullscreenControl(t.options);break;case"pitch":n=new a.control.PitchControl(t.options);break;case"scale":n=new a.control.ScaleControl(t.options);break;case"style":n=new a.control.StyleControl(t.options);break;case"traffic":n=new a.control.TrafficControl(t.options);break;case"zoom":n=new a.control.ZoomControl(t.options);break;default:b.logMessage(e,s.Warn,`addControls: control type '${t.type}' is not supported.`)}if(n){const e={id:t.id,interopId:t.interopId,type:t.type};n.jsInterop=e,o.controls.add(n,t.controlOptions)}})}static remove(e,t){const a=G.getMap(e);if(!a)return;const s=a.controls.getControls();t.forEach(t=>{let o=this.#e(s,e,t.interopId);o&&a.controls.remove(o)})}static getControl(e,t){const a=G.getMap(e);if(!a)return;const s=a.controls.getControls();return this.#e(s,e,t)}static getControls(e){const t=G.getMap(e);if(!t)return;const a=t.controls.getControls(),s=[];return a.filter(e=>C.isInteropControl(e)).forEach(e=>{const t=e.jsInterop;t&&s.push(t)}),s}static#e(e,t,a){const o=e.findLast(e=>C.isInteropControl(e,a));return o||b.logMessage(t,s.Debug,`getControl: control not found where id = '${a}'`),o}}class S{mapId;#t;#a=new Map;constructor(e){this.mapId=e,this.#t=new V(e)}getMap(){return this.#t.getMap()}getDotNetRef(){return this.#t.getDotNetRef()}addCallback(e,t){const a=this.#s(e);this.#a.has(a)||(this.#a.set(a,t),b.logMessage(this.mapId,s.Trace,"EventFactoryBase:adding event:",a))}getCallback(e,t){const a=this.#s(e);if(this.#a.has(a)){const e=this.#a.get(a);if(t){const e=this.#a.delete(a);b.logMessage(this.mapId,s.Trace,"EventFactoryBase:removing event:",a,e)}return e}}#s(e){return`${e.target}.${e.type}.${e.targetId}`}}class D{static logEventAdd(e,t,a,o){a?b.logMessage(e,s.Trace,`${t}: event added:`,o):b.logMessage(e,s.Error,`${t}: event not supported:`,o)}static logEventRemoved(e,t,a,o){a?b.logMessage(e,s.Trace,`${t}: event removed:`,o):b.logMessage(e,s.Error,`${t}: event not supported:`,o)}static logInvalidTargetId(e,t,a){b.logMessage(e,s.Error,`${t}: 'once' is not supported:`,a),b.logMessage(e,s.Error,`${t}: invalid TargetId.`,a)}static logOnceNotSupported(e,t,a){b.logMessage(e,s.Error,`${t}: 'once' is not supported:`,a)}static logNotifyFired(e,t,...a){b.logMessage(e,s.Trace,`${t}: event was fired.`,a)}static logTrace(e,t,...a){b.logMessage(e,s.Trace,t,a)}}!function(e){e.NotifyMapEvent="NotifyMapEvent",e.NotifyMapEventConfig="NotifyMapEventConfig",e.NotifyMapEventData="NotifyMapEventData",e.NotifyMapEventDataSource="NotifyMapEventDataSource",e.NotifyMapEventError="NotifyMapEventError",e.NotifyMapEventGeneral="NotifyMapEventGeneral",e.NotifyMapEventHtmlMarker="NotifyMapEventHtmlMarker",e.NotifyMapEventLayer="NotifyMapEventLayer",e.NotifyMapEventMouse="NotifyMapEventMouse",e.NotifyMapEventPopup="NotifyMapEventPopup",e.NotifyMapEventReady="NotifyMapEventReady",e.NotifyMapEventShape="NotifyMapEventShape",e.NotifyMapEventSource="NotifyMapEventSource",e.NotifyMapEventStyle="NotifyMapEventStyle",e.NotifyMapEventTouch="NotifyMapEventTouch",e.NotifyMapEventWheel="NotifyMapEventWheel",e.NotifyMapReady="NotifyMapReady"}(o||(o={})),function(e){e.Click="click",e.ContextMenu="contextmenu",e.DblClick="dblclick",e.MouseDown="mousedown",e.MouseMove="mousemove",e.MouseOut="mouseout",e.MouseOver="mouseover",e.MouseUp="mouseup"}(n||(n={})),function(e){e.TouchCancel="touchcancel",e.TouchEnd="touchend",e.TouchMove="touchmove",e.TouchStart="touchstart"}(r||(r={})),function(e){e.Wheel="wheel"}(i||(i={}));class N extends S{constructor(e){super(e)}addEvents(e){0!=e.length&&this.#o(Object.values(e).filter(e=>"map"===e.target))}removeEvents(e){0!=e.length&&this.#n(Object.values(e).filter(e=>"map"===e.target))}#o(e){0!=e.length&&(this.#r(e),this.#i(e),this.#l(e),this.#d(e),this.#c(e),this.#p(e),this.#u(e),this.#v(e),this.#g(e))}#n(e){0!=e.length&&(this.#h(e),this.#y(e),this.#E(e),this.#M(e),this.#m(e),this.#f(e),this.#I(e),this.#b(e),this.#C(e))}#r(e){if(0==e.length)return;const t=this.getMap(),a="addMapEventConfig";Object.values(e).filter(e=>C.isValueInEnum(l,e.type)).forEach(e=>{let s=!1;const o=this.#k(e,!1);o&&(e.once?D.logOnceNotSupported(this.mapId,a,e):(t.events.add(e.type,o),s=!0)),D.logEventAdd(this.mapId,a,s,e)})}#h(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(l,e.type)).forEach(e=>{let a=!1;const s=this.#k(e,!0);s&&(t.events.remove(e.type,s),a=!0),D.logEventRemoved(this.mapId,"removeMapEventConfig",a,e)})}#k(e,t){let a=this.getCallback(e,t);return a||(a=t=>this.#S(t,e),this.addCallback(e,a),a)}#S=(e,t)=>{let a=C.buildEventResult(this.mapId,t,e);this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventConfig,a),D.logNotifyFired(this.mapId,o.NotifyMapEventConfig,t.type)};#i(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(d,e.type)).forEach(e=>{let a=!1;const s=this.#D(e,!1);s&&(e.once?t.events.addOnce(e.type,s):t.events.add(e.type,s),a=!0),D.logEventAdd(this.mapId,"addMapEventData",a,e)})}#y(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(d,e.type)).forEach(e=>{let a=!1;const s=this.#D(e,!0);s&&(t.events.remove(e.type,s),a=!0),D.logEventRemoved(this.mapId,"removeMapEventData",a,e)})}#D(e,t){let a=this.getCallback(e,t);return a||(a=t=>this.#N(t,e),this.addCallback(e,a),a)}#N=(e,t)=>{let a=C.buildEventResult(this.mapId,t,this.#O(e));this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventData,a),D.logNotifyFired(this.mapId,o.NotifyMapEventData,t.type)};#O(e){return{dataType:e.dataType,isSourceLoaded:e.isSourceLoaded,source:e.source?.getId(),sourceDataType:e.sourceDataType,tile:e.tile}}#l(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(c,e.type)).forEach(e=>{let a=!1;const s=this.#T(e,!1);s&&(e.once?t.events.addOnce(e.type,s):t.events.add(e.type,s),a=!0),D.logEventAdd(this.mapId,"addMapEventGeneral",a,e)})}#E(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(c,e.type)).forEach(e=>{let a=!1;const s=this.#T(e,!0);s&&(t.events.remove(e.type,s),a=!0),D.logEventRemoved(this.mapId,"removeMapEventGeneral",a,e)})}#T(e,t){let a=this.getCallback(e,t);return a||(a=t=>{this.#R(t,e)},this.addCallback(e,a),a)}#R=(e,t)=>{let a=C.buildEventResult(this.mapId,t);this.getDotNetRef().invokeMethodAsync(o.NotifyMapEvent,a),D.logNotifyFired(this.mapId,o.NotifyMapEvent,t.type)};#d(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(p,e.type)).forEach(e=>{let a=!1;const s=this.#L(e,!1);s&&(e.once?t.events.addOnce(e.type,s):t.events.add(e.type,s),a=!0),D.logEventAdd(this.mapId,"addMapEventLayer",a,e)})}#M(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(p,e.type)).forEach(e=>{let a=!1;const s=this.#L(e,!0);s&&(t.events.remove(e.type,s),a=!0),D.logEventRemoved(this.mapId,"removeMapEventLayer",a,e)})}#L(e,t){let a=this.getCallback(e,t);return a||(a=t=>{this.#w(t,e)},this.addCallback(e,a),a)}#w=(e,t)=>{let a=C.buildEventResult(this.mapId,t,C.buildLayerPayload(e));this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventGeneral,a),D.logNotifyFired(this.mapId,o.NotifyMapEventGeneral,t.type)};#c(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(n,e.type)).forEach(e=>{let a=!1,s=this.#j(e,!1);s&&(e.once?t.events.addOnce(e.type,s):t.events.add(e.type,s),a=!0),D.logEventAdd(this.mapId,"addMapEventMouse",a,e)})}#m(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(n,e.type)).forEach(e=>{let a=!1,s=this.#j(e,!0);s&&(t.events.remove(e.type,s),a=!0),D.logEventRemoved(this.mapId,"removeMapEventMouse",a,e)})}#j(e,t){let a=this.getCallback(e,t);return a||(a=t=>this.#P(t,e),this.addCallback(e,a),a)}#P=(e,t)=>{t.preventDefault&&e.preventDefault();let a=C.buildMouseEventPayload(e),s=C.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventMouse,s),D.logNotifyFired(this.mapId,o.NotifyMapEventMouse,t.type)};#p(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(u,e.type)).forEach(e=>{let a=!1;const s=this.#A(e,!1);s&&(e.once?t.events.addOnce(e.type,s):t.events.add(e.type,s),a=!0),D.logEventAdd(this.mapId,"addMapEventSource",a,e)})}#f(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(u,e.type)).forEach(e=>{let a=!1;const s=this.#A(e,!0);s&&(t.events.remove(e.type,s),a=!0),D.logEventRemoved(this.mapId,"removeMapEventSource",a,e)})}#A(e,t){let a=this.getCallback(e,t);return a||(a=t=>this.#F(t,e),this.addCallback(e,a),a)}#F(e,t){let a={id:e.getId(),jsInterop:C.getJsInterop(e)},s=C.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventSource,s),D.logNotifyFired(this.mapId,o.NotifyMapEventSource,t.type)}#u(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(v,e.type)).forEach(e=>{let a=!1;const s=this.#x(e,!1);s&&(t.events.addOnce(e.type,s),a=!0),D.logEventAdd(this.mapId,"addMapEventStyle",a,e)})}#I(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(v,e.type)).forEach(e=>{let a=!1;const s=this.#x(e,!0);s&&(t.events.remove(e.type,s),a=!0),D.logEventRemoved(this.mapId,"removeMapEventStyle",a,e)})}#x(e,t){let a=this.getCallback(e,t);if(a)return a;switch(e.type.toLowerCase()){case v.StyleChanged:a=t=>this.#$(t.style,e);break;case v.StyleImageMissing:a=t=>this.#$(t,e)}return this.addCallback(e,a),a}#$(e,t){let a={style:e},s=C.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventStyle,s),D.logNotifyFired(this.mapId,o.NotifyMapEventStyle,t.type)}#v(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(r,e.type)).forEach(e=>{let a=!1;const s=this.#V(e,!1);s&&(e.once?t.events.addOnce(e.type,s):t.events.add(e.type,s),a=!0),D.logEventAdd(this.mapId,"addMapEventTouch",a,e)})}#b(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(r,e.type)).forEach(e=>{let a=!1;const s=this.#V(e,!0);s&&(t.events.remove(e.type,s),a=!0),D.logEventRemoved(this.mapId,"removeMapEventTouch",a,e)})}#V(e,t){let a=this.getCallback(e,t);return a||(a=t=>this.#W(t,e),this.addCallback(e,a),a)}#W=(e,t)=>{t.preventDefault&&e.preventDefault();let a=C.buildTouchEventPayload(e),s=C.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventTouch,s),D.logNotifyFired(this.mapId,o.NotifyMapEventTouch,t.type)};#g(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(i,e.type)).forEach(e=>{let a=!1,s=this.#G(e,!1);s&&(e.once?t.events.addOnce(e.type,s):t.events.add(e.type,s),a=!0),D.logEventAdd(this.mapId,"addMapEventWheel",a,e)})}#C(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>C.isValueInEnum(i,e.type)).forEach(e=>{let a=!1,s=this.#G(e,!0);s&&(t.events.remove(e.type,s),a=!0),D.logEventRemoved(this.mapId,"removeMapEventWheel",a,e)})}#G(e,t){let a=this.getCallback(e,t);return a||(a=t=>this.#B(t,e),this.addCallback(e,a),a)}#B=(e,t)=>{t.preventDefault&&e.preventDefault();let a=C.buildWheelEventPayload(e),s=C.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventWheel,s),D.logNotifyFired(this.mapId,o.NotifyMapEventWheel,t.type)}}!function(e){e.MapConfigChanged="mapconfigurationchanged"}(l||(l={})),function(e){e.Data="data",e.SourceData="sourcedata",e.StyleData="styledata"}(d||(d={})),function(e){e.BoxZoomEnd="boxzoomend",e.BoxZoomStart="boxzoomstart",e.Drag="drag",e.DragEnd="dragend",e.DragStart="dragstart",e.Idle="idle",e.Load="load",e.Move="move",e.MoveEnd="moveend",e.MoveStart="movestart",e.Pitch="pitch",e.PitchEnd="pitchend",e.PitchStart="pitchstart",e.Render="render",e.Resize="resize",e.Rotate="rotate",e.RotateEnd="rotateend",e.RotateStart="rotatestart",e.TokenAcquired="tokenacquired",e.Zoom="zoom",e.ZoomEnd="zoomend",e.ZoomStart="zoomstart"}(c||(c={})),function(e){e.LayerAdded="layeradded",e.LayerRemoved="layerremoved"}(p||(p={})),function(e){e.SourceAdded="sourceadded",e.SourceRemoved="sourceremoved"}(u||(u={})),function(e){e.StyleChanged="stylechanged",e.StyleImageMissing="styleimagemissing"}(v||(v={}));class O{static add(e,t){const s=G.getMap(e);s&&t.forEach(e=>{let t={...e.options};t.popup&&(t.popup=new a.Popup(t.popup.options));let o=new a.HtmlMarker(t);const n={id:e.id,interopId:e.interopId};o.jsInterop=n,s.markers.add(o),e.togglePopupOnClick&&s.events.add("click",o,()=>{o.togglePopup()})})}static remove(e,t){const a=G.getMap(e);a&&t.forEach(t=>{let s=this.#z(a,e,t.interopId);s&&a.markers.remove(s)})}static getMarker(e,t){const a=G.getMap(e);if(a)return this.#z(a,e,t)}static#z(e,t,a){const o=e.markers.getMarkers().findLast(e=>this.#H(e,a));return o||b.logMessage(t,s.Debug,`getMarker: marker not found where id = '${a}'`),o}static#H(e,t){let a=e&&null!=e.jsInterop&&null!=e.jsInterop.interopId;return a&&C.isNotEmptyOrNull(t)&&(a=e.jsInterop.id===t||e.jsInterop.interopId===t),a}}class T extends S{constructor(e){super(e)}addEvents(e){0!=e.length&&this.#U(Object.values(e).filter(e=>"htmlmarker"===e.target))}removeEvents(e){0!=e.length&&this.#J(Object.values(e).filter(e=>"htmlmarker"===e.target))}#U(e){if(0==e.length)return;const t=this.getMap(),a="addHtmlMarkerEvents";Object.values(e).filter(e=>C.isValueInEnum(g,e.type)).forEach(e=>{const s=this.#Z(e);let o=!1;if(s){const n=this.#q(e,!1);n&&(e.once?t.events.addOnce(e.type,s,n):t.events.add(e.type,s,n),o=!0),D.logEventAdd(this.mapId,a,o,e)}else D.logInvalidTargetId(this.mapId,a,e)})}#J(e){if(0==e.length)return;const t=this.getMap(),a="removeHtmlMarkerEvents";Object.values(e).filter(e=>C.isValueInEnum(g,e.type)).forEach(e=>{const s=this.#Z(e);let o=!1;if(s){const n=this.#q(e,!0);n&&(t.events.remove(e.type,s,n),o=!0),D.logEventRemoved(this.mapId,a,o,e)}else D.logInvalidTargetId(this.mapId,a,e)})}#q(e,t){let a=this.getCallback(e,t);return a||(a=t=>this.#_(t,e),this.addCallback(e,a),a)}#Z(e){return O.getMarker(this.mapId,e.targetId)}#_=(e,t)=>{let a=C.buildTargetedEventPayload(e),s=C.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventHtmlMarker,s),D.logNotifyFired(this.mapId,o.NotifyMapEventHtmlMarker,t.type)}}!function(e){e.Click="click",e.ContextMenu="contextmenu",e.DblClick="dblclick",e.MouseDown="mousedown",e.MouseEnter="mouseenter",e.MouseLeave="mouseleave",e.MouseMove="mousemove",e.MouseOut="mouseout",e.MouseOver="mouseover",e.MouseUp="mouseup",e.Drag="drag",e.DragEnd="dragend",e.DragStart="dragstart",e.KeyDown="keydown",e.KeyPress="keypress",e.KeyUp="keyup"}(g||(g={}));class R{static getDataSourceShapes(e,t){const a=G.getMap(e);if(!a)return;let s=[];const o=this.getDataSource(a,e,t);return o&&(s=C.buildShapeResults(o.getShapes())),s}static clearDatasource(e,t){const a=G.getMap(e);if(!a)return;const o=this.getDataSource(a,e,t);o&&(o.clear(),b.logMessage(e,s.Debug,`- clearDatasource: datasource with ID '${t}' was cleared.`))}static createDatasource(e,t,o){const n=G.getMap(e);if(!n)return;if(n.sources.getById(t.id))return void b.logMessage(e,s.Warn,`- createDatasource: datasource with ID '${t.id}' already exists.`);const r=new a.source.DataSource(t.id,t.options),i={id:t.id,interopId:t.interopId};r.jsInterop=i,o&&G.getMapContainer(e).events.addDataSourceEvents(o,r),n.sources.add(r),t.url&&r.importDataFromUrl(t.url)}static removeDatasource(e,t){const a=G.getMap(e);if(!a)return;const o=a.sources.getById(t);o&&(a.sources.remove(o),b.logMessage(e,s.Debug,`- removeDatasource: datasource with ID '${t}' was removed.`))}static getDataSource(e,t,o){const n=e.sources.getById(o);if(n instanceof a.source.DataSource)return n;b.logMessage(t,s.Debug,`getDataSource: source with ID '${o}' is not a DataSource.`)}}class L extends S{constructor(e){super(e)}addEvents(e,t){0!=e.length&&this.#K(this.#Q(e),t)}removeEvents(e,t){0!=e.length&&this.#X(this.#Q(e),t)}#Q(e){return Object.values(e).filter(e=>"datasource"===e.target&&C.isValueInEnum(h,e.type))}#K(e,t){if(0==e.length)return;const a=this.getMap(),s="addDataSourceEvents";e.forEach(e=>{const o=t??this.#Z(a,e);let n=!1;if(t&&(e.targetId=t.getId()),o){const t=this.#q(e,!1);t&&(e.once?a.events.addOnce(e.type,o,t):a.events.add(e.type,o,t),n=!0),D.logEventAdd(this.mapId,s,n,e)}else D.logInvalidTargetId(this.mapId,s,e)})}#X(e,t){if(0==e.length)return;const a=this.getMap(),s="removeDataSourceEvents";e.forEach(e=>{const o=t??this.#Z(a,e);let n=!1;if(t&&(e.targetId=t.getId()),o){const t=this.#q(e,!0);t&&(a.events.remove(e.type,o,t),n=!0),D.logEventRemoved(this.mapId,s,n,e)}else D.logInvalidTargetId(this.mapId,s,e)})}#q(e,t){let a=this.getCallback(e,t);return a||(a=e.type.toLowerCase()===h.DataSourceUpdated?t=>this.#Y(t,e):t=>this.#ee(t,e),this.addCallback(e,a),a)}#Z(e,t){return R.getDataSource(e,this.mapId,t.targetId)}#Y=(e,t)=>{let a=C.buildEventResult(this.mapId,t,C.buildDataSourcePayload(e));this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventDataSource,a),D.logNotifyFired(this.mapId,o.NotifyMapEventDataSource,t.type)};#ee=(e,t)=>{let a={shapes:C.buildShapeResults(e)},s=C.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventDataSource,s),D.logNotifyFired(this.mapId,o.NotifyMapEventDataSource,t.type,s)}}!function(e){e.DataSourceUpdated="datasourceupdated",e.DataAdded="dataadded",e.DataRemoved="dataremoved"}(h||(h={}));class w extends S{constructor(e){super(e)}addEvents(e){0!=e.length&&this.#te(Object.values(e).filter(e=>"stylecontrol"===e.target))}removeEvents(e){0!=e.length&&this.#ae(Object.values(e).filter(e=>"stylecontrol"===e.target))}#te(e){if(0==e.length)return;const t=this.getMap(),a="addStyleControlEvents";Object.values(e).filter(e=>C.isValueInEnum(y,e.type)).forEach(e=>{const s=k.getControl(this.mapId,e.targetId);if(s){let o=!1;const n=this.#q(e,!1);n&&(e.once?t.events.addOnce(e.type,s,n):t.events.add(e.type,s,n),o=!0),D.logEventAdd(this.mapId,a,o,e)}else D.logInvalidTargetId(this.mapId,a,e)})}#ae(e){if(0==e.length)return;const t=this.getMap(),a="removeStyleControlEvents";Object.values(e).filter(e=>C.isValueInEnum(y,e.type)).forEach(e=>{const s=k.getControl(this.mapId,e.targetId);if(s){let o=!1;const n=this.#q(e,!0);n&&(t.events.remove(e.type,s,n),o=!0),D.logEventRemoved(this.mapId,a,o,e)}else D.logInvalidTargetId(this.mapId,a,e)})}#q(e,t){let a=this.getCallback(e,t);return a||(a=t=>this.#se(t,e),this.addCallback(e,a),a)}#se=(e,t)=>{let a=C.buildEventResult(this.mapId,t,{style:e});this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventStyle,a),D.logNotifyFired(this.mapId,o.NotifyMapEventStyle,t.type)}}!function(e){e.StyleSelected="styleselected"}(y||(y={}));class j extends S{constructor(e){super(e)}addEvents(e,t){0!=e.length&&this.#oe(this.#Q(e),t)}removeEvents(e,t){0!=e.length&&this.#ne(this.#Q(e),t)}#Q(e){return Object.values(e).filter(e=>"layer"===e.target&&C.isValueInEnum(E,e.type))}#oe(e,t){if(0==e.length)return;const a=this.getMap(),s="addLayerEvents";e.forEach(e=>{let o=!1;const n=t??this.#Z(a,e);if(t&&(e.targetId=t.getId()),!n)return void D.logInvalidTargetId(this.mapId,s,e);const r=this.#q(e,!1);r&&n&&(e.once?a.events.addOnce(e.type,n,r):a.events.add(e.type,n,r),o=!0),D.logEventAdd(this.mapId,s,o,e)})}#ne(e,t){if(0==e.length)return;const a=this.getMap(),s="removeLayerEvents";e.forEach(e=>{let o=!1;const n=t??this.#Z(a,e);if(t&&(e.targetId=t.getId()),!n)return void D.logInvalidTargetId(this.mapId,s,e);const r=this.#q(e,!0);r&&(n?(a.events.remove(e.type,n,r),o=!0):D.logInvalidTargetId(this.mapId,s,e)),D.logEventRemoved(this.mapId,s,o,e)})}#Z(e,t){if("layer"===t.target)return e.layers.getLayerById(t.targetId)}#q(e,t){let a=this.getCallback(e,t);if(a)return a;switch(e.type){case E.LayerAdded:case E.LayerRemoved:a=t=>this.#w(t,e);break;case E.Click:case E.ContextMenu:case E.DblClick:case E.MouseDown:case E.MouseEnter:case E.MouseLeave:case E.MouseMove:case E.MouseOut:case E.MouseOver:case E.MouseUp:a=t=>this.#re(t,e);break;case E.TouchCancel:case E.TouchEnd:case E.TouchMove:case E.TouchStart:a=a=t=>this.#ie(t,e);break;case E.Wheel:a=t=>this.#le(t,e)}return this.addCallback(e,a),a}#w=(e,t)=>{let a=C.buildEventResult(this.mapId,t,C.buildLayerPayload(e));this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventLayer,a),D.logNotifyFired(this.mapId,o.NotifyMapEventLayer,t.type)};#ie=(e,t)=>{t.preventDefault&&e.preventDefault();let a={id:t.targetId,touch:C.buildTouchEventPayload(e)},s=C.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventLayer,s),D.logNotifyFired(this.mapId,o.NotifyMapEventLayer,t.type)};#re=(e,t)=>{t.preventDefault&&e.preventDefault();let a={id:t.targetId,mouse:C.buildMouseEventPayload(e)},s=C.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventLayer,s),D.logNotifyFired(this.mapId,o.NotifyMapEventLayer,t.type)};#le=(e,t)=>{t.preventDefault&&e.preventDefault();let a={id:t.targetId,wheel:C.buildWheelEventPayload(e)},s=C.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventLayer,s),D.logNotifyFired(this.mapId,o.NotifyMapEventLayer,t.type)}}!function(e){e.LayerAdded="layeradded",e.LayerRemoved="layerremoved",e.Click="click",e.ContextMenu="contextmenu",e.DblClick="dblclick",e.MouseDown="mousedown",e.MouseEnter="mouseenter",e.MouseLeave="mouseleave",e.MouseMove="mousemove",e.MouseOut="mouseout",e.MouseOver="mouseover",e.MouseUp="mouseup",e.TouchCancel="touchcancel",e.TouchEnd="touchend",e.TouchMove="touchmove",e.TouchStart="touchstart",e.Wheel="wheel"}(E||(E={}));class P extends S{constructor(e){super(e)}addEvents(e){0!=e.length&&this.#de(Object.values(e).filter(e=>"shape"===e.target))}removeEvents(e){0!=e.length&&this.#ce(Object.values(e).filter(e=>"shape"===e.target))}#de(e){if(0==e.length)return;const t=this.getMap(),a="addShapeEvents";Object.values(e).filter(e=>C.isValueInEnum(M,e.type)).forEach(e=>{const s=this.#Z(t,e);let o=!1;if(s){const n=this.#q(e,!1);n&&(e.once?t.events.addOnce(e.type,s,n):t.events.add(e.type,s,n),o=!0),D.logEventAdd(this.mapId,a,o,e)}else D.logInvalidTargetId(this.mapId,a,e)})}#ce(e){if(0==e.length)return;const t=this.getMap(),a="removeShapeEvents";Object.values(e).filter(e=>C.isValueInEnum(M,e.type)).forEach(e=>{const s=this.#Z(t,e);let o=!1;if(s){const n=this.#q(e,!0);n&&(t.events.remove(e.type,s,n),o=!0),D.logEventRemoved(this.mapId,a,o,e)}else D.logInvalidTargetId(this.mapId,a,e)})}#q(e,t){let a=this.getCallback(e,t);return a||(a=t=>this.#pe(t,e),this.addCallback(e,a),a)}#Z(e,t){return e.sources.getById(t.targetSourceId).getShapeById(t.targetId)}#pe=(e,t)=>{let a=C.getShapeResult(e),s=C.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventShape,s),D.logNotifyFired(this.mapId,o.NotifyMapEventShape,t.type)}}!function(e){e.ShapeChanged="shapechanged"}(M||(M={}));class A{static add(e,t){const s=G.getMap(e);s&&t.forEach(e=>{let t=new a.Popup(e.options);const o={id:e.id,interopId:e.interopId};t.jsInterop=o,s.popups.add(t)})}static remove(e,t){const a=G.getMap(e);a&&t.forEach(t=>{let s=this.#ue(a,e,t.interopId);s&&a.popups.remove(s)})}static getPopup(e,t){const a=G.getMap(e);if(a)return this.#ue(a,e,t)}static#ue(e,t,a){const o=e.popups.getPopups().findLast(e=>this.#ve(e,a));return o||b.logMessage(t,s.Debug,`getPopup: popup not found where id = '${a}'`),o}static#ve(e,t){let a=e&&null!=e.jsInterop&&null!=e.jsInterop.interopId;return a&&C.isNotEmptyOrNull(t)&&(a=e.jsInterop.id===t||e.jsInterop.interopId===t),a}}class F extends S{constructor(e){super(e)}addEvents(e){0!=e.length&&this.#ge(Object.values(e).filter(e=>"popup"===e.target))}removeEvents(e){0!=e.length&&this.#he(Object.values(e).filter(e=>"popup"===e.target))}#ge(e){if(0==e.length)return;const t=this.getMap(),a="addPopupEvents";Object.values(e).filter(e=>C.isValueInEnum(m,e.type)).forEach(e=>{const s=this.#Z(e);let o=!1;if(s){const n=this.#q(e,!1);n&&(e.once?t.events.addOnce(e.type,s,n):t.events.add(e.type,s,n),o=!0),D.logEventAdd(this.mapId,a,o,e)}else D.logInvalidTargetId(this.mapId,a,e)})}#he(e){if(0==e.length)return;const t=this.getMap(),a="removePopupEvents";Object.values(e).filter(e=>C.isValueInEnum(m,e.type)).forEach(e=>{const s=this.#Z(e);let o=!1;if(s){const n=this.#q(e,!0);n&&(t.events.remove(e.type,s,n),o=!0),D.logEventRemoved(this.mapId,a,o,e)}else D.logInvalidTargetId(this.mapId,a,e)})}#q(e,t){let a=this.getCallback(e,t);return a||(a=t=>this.#ye(t,e),this.addCallback(e,a),a)}#Z(e){return A.getPopup(this.mapId,e.targetId)}#ye=(e,t)=>{let a=C.buildTargetedEventPayload(e),s=C.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(o.NotifyMapEventPopup,s),D.logNotifyFired(this.mapId,o.NotifyMapEventPopup,t.type)}}!function(e){e.Drag="drag",e.DragEnd="dragend",e.DragStart="dragstart",e.Open="open",e.Close="close"}(m||(m={}));class x extends S{mapEvents;markerEvents;sourceEvents;styleControlEvents;layerEvents;shapeEvents;popupEvents;constructor(e){super(e),this.mapEvents=new N(e),this.markerEvents=new T(e),this.sourceEvents=new L(e),this.styleControlEvents=new w(e),this.layerEvents=new j(e),this.shapeEvents=new P(e),this.popupEvents=new F(e)}addEvents(e){0!=e.length&&(this.mapEvents.addEvents(e),this.markerEvents.addEvents(e),this.sourceEvents.addEvents(e),this.styleControlEvents.addEvents(e),this.layerEvents.addEvents(e),this.shapeEvents.addEvents(e),this.popupEvents.addEvents(e))}addDataSourceEvents(e,t){0!=e.length&&this.sourceEvents.addEvents(e,t)}addLayerEvents(e,t){0!=e.length&&this.layerEvents.addEvents(e,t)}removeEvents(e){0!=e.length&&(this.mapEvents.removeEvents(e),this.markerEvents.removeEvents(e),this.sourceEvents.removeEvents(e),this.styleControlEvents.removeEvents(e),this.layerEvents.removeEvents(e),this.shapeEvents.removeEvents(e),this.popupEvents.removeEvents(e))}removeDataSourceEvents(e,t){0!=e.length&&this.sourceEvents.removeEvents(e,t)}removeLayerEvents(e,t){0!=e.length&&this.layerEvents.removeEvents(e,t)}}class ${dotNetRef;mapId;azMap;events;constructor(e,t,a){this.dotNetRef=e,this.mapId=t,this.azMap=a,this.events=new x(t)}clear(){this.dotNetRef=null,this.mapId=null,this.azMap=null}}class V{mapId;constructor(e){this.mapId=e}getContainer(){return G.getMapContainer(this.mapId)}getMap(){return this.getContainer().azMap}getDotNetRef(){return this.getContainer().dotNetRef}}class W{static addEvents(e,t){G.getMapContainer(e).events.addEvents(t)}static removeEvents(e,t){G.getMapContainer(e).events.removeEvents(t)}static addControls(e,t){k.add(e,t)}static getControls(e){return k.getControls(e)}static removeControls(e,t){k.remove(e,t)}static clearDatasource(e,t){R.clearDatasource(e,t)}static createDatasource(e,t){R.createDatasource(e,t)}static getDataSourceShapes(e,t){return R.getDataSourceShapes(e,t)}static removeDatasource(e,t){R.removeDatasource(e,t)}static addMarkers(e,t){O.add(e,t)}static removeMarkers(e,t){O.remove(e,t)}static addPopups(e,t){A.add(e,t)}static removePopups(e,t){A.remove(e,t)}static getTraffic(e){const t=G.getMap(e);if(t)return t.getTraffic()}static setTraffic(e,t){const a=G.getMap(e);a&&a.setTraffic(t)}}class G{static#Ee=new Map;static getAuthTokenCallback;static createMap(e,t,o,n,r){if(b.currentLevel=o.logLevel??s.Information,this.#Ee.has(t))return void b.logMessage(t,s.Warn,"Map already exists.");const i=this.#Me(o.authOptions,o.options),l=new a.Map(t,i);this.#Ee.set(t,new $(e,t,l)),b.logMessage(t,s.Debug,"was created."),r&&k.add(t,r),this.#me(e,t,n)}static getMap(e){const t=this.getMapContainer(e);return t?.azMap}static getMapContainer(e){const t=this.#Ee.get(e);return t||b.logMessage(e,s.Debug,"mapContainer was not found."),t}static removeMap(e){const t=this.#Ee.get(e);t&&this.#Ee.delete(e)&&(t.clear(),b.logMessage(e,s.Debug,"was removed"))}static#Me(e,t){let a={};return t&&(t.camera?a={...a,...t.camera}:t.cameraBounds&&(a={...a,...t.cameraBounds}),t.service&&(a={...a,...t.service}),t.style&&(a={...a,...t.style}),t.userInteraction&&(a={...a,...t.userInteraction})),a.authOptions=e,a.authOptions.getToken=this.getAuthTokenCallback,a}static#me(e,t,a){const n=this.getMap(t);n?(a??=[],n.events.addOnce(f.Ready,r=>{const i={target:"map",type:f.Error},l={target:"map",type:f.Ready};n.events.add(f.Error,a=>{const n={message:a.error.message,name:a.error.name,stack:a.error.stack,cause:a.error.cause};let r=C.buildEventResult(t,i,n);b.logMessage(t,s.Error,"Map error",r),e.invokeMethodAsync(o.NotifyMapEventError,r)}),W.addEvents(t,a);let d=C.buildEventResult(t,l);e.invokeMethodAsync(o.NotifyMapReady,d),e.invokeMethodAsync(o.NotifyMapEventReady,d)})):b.logMessage(t,s.Error,"Cannot build events. Map not found.")}}!function(e){e.Error="error",e.Ready="ready"}(f||(f={}));class B{static getCamera(e){const t=G.getMap(e);if(t)return t.getCamera()}static setCamera(e,t){const a=G.getMap(e);if(!a)return;let s=this.#fe(t);a.setCamera(s)}static getMapOptions(e){const t=G.getMap(e);if(t)return{mapCamera:t.getCamera(),service:t.getServiceOptions(),style:t.getStyle(),userInteraction:t.getUserInteraction()}}static setMapOptions(e,t){const a=G.getMap(e);if(!a)return;let s=this.#fe(t.camera);a.setCamera(s),t.service&&a.setServiceOptions(t.service),t.style&&a.setStyle(t.style),t.userInteraction&&a.setUserInteraction(t.userInteraction)}static getServiceOptions(e){const t=G.getMap(e);if(t)return t.getServiceOptions()}static setServiceOptions(e,t){const a=G.getMap(e);a&&a.setServiceOptions(t)}static getStyle(e){const t=G.getMap(e);if(t)return t.getStyle()}static setStyle(e,t){const a=G.getMap(e);a&&a.setStyle(t)}static getUserInteraction(e){const t=G.getMap(e);if(t)return t.getUserInteraction()}static setUserInteraction(e,t){const a=G.getMap(e);a&&a.setUserInteraction(t)}static#fe(e){let t={};return e.camera?t={...e.camera,...e.animation}:e.cameraBounds&&(t={...e.cameraBounds,...e.animation}),t}}class z{static addFeature(e,t,a,s){const o=G.getMap(e);if(!o)return;const n=R.getDataSource(o,e,a);n&&this.#Ie(o,e,t,n,s)}static addFeatures(e,t,a,s){const o=G.getMap(e);if(!o)return;const n=R.getDataSource(o,e,a);n&&t.forEach(t=>{this.#Ie(o,e,t,n,s)})}static#Ie(e,t,o,n,r){if(r&&o.id){const e=n.getShapeById(o.id);e&&n.remove(e)}let i;switch(o.geometry.type.toLowerCase()){case I.Point:i=new a.data.Point(o.geometry.coordinates);break;case I.MultiPoint:i=new a.data.MultiPoint(o.geometry.coordinates,o.bbox);break;case I.LineString:i=new a.data.LineString(o.geometry.coordinates,o.bbox);break;case I.Polygon:i=new a.data.Polygon(o.geometry.coordinates,o.bbox)}if(!i)return void b.logMessage(t,s.Error,`adding feature error: geometry type '${o.geometry.type}' not supported`);const l={id:o.id,interopId:o.interopId},d={...o.properties,jsInterop:l};let c=new a.data.Feature(i,d,o.id);if(o.asShape){let e=new a.Shape(c);n.add(e)}else n.add(c)}static updateFeature(e,t,a){const s=G.getMap(e);if(!s)return;const o=R.getDataSource(s,e,a);if(!o)return;const n=o.getShapeById(t.id);n&&n.setCoordinates(t.geometry.coordinates)}static updateFeatures(e,t,a){const s=G.getMap(e);if(!s)return;const o=R.getDataSource(s,e,a);o&&t.forEach(e=>{const t=o.getShapeById(e.id);t&&t.setCoordinates(e.geometry.coordinates)})}}!function(e){e.Point="point",e.MultiPoint="multipoint",e.LineString="linestring",e.MultiLineString="multilinestring",e.Polygon="polygon",e.MultiPolygon="multipolygon"}(I||(I={}));class H{static createLayer(e,t,o,n){const r=G.getMap(e);if(!r)return;const i="createLayer";if(C.isEmptyOrNull(t.type))return void b.logMessage(e,s.Error,`${i}: layer type is missing`);const l=t.id;if(C.isNotEmptyOrNull(l)&&r.layers.getLayerById(l))return void b.logMessage(e,s.Error,`${i}: layer already exists where ID=${l}`);let d,c;if(o){if(R.createDatasource(e,o,n),d=R.getDataSource(r,e,o.id),!d)return void b.logMessage(e,s.Error,`${i}: Unable to create datasource.`,o)}else if(d=R.getDataSource(r,e,o.id),!d)return void b.logMessage(e,s.Error,`${i}: Unable to find datasource where ID=${t.sourceId}.`);const p=t.options||{};switch(t.type){case"Bubble":c=new a.layer.BubbleLayer(d,l,p);break;case"HeatMap":c=new a.layer.HeatMapLayer(d,l,p);break;case"Image":c=new a.layer.ImageLayer(p,l);break;case"Line":c=new a.layer.LineLayer(d,l,p);break;case"Polygon":c=new a.layer.PolygonLayer(d,l,p);break;case"PolygonExtrusion":c=new a.layer.PolygonExtrusionLayer(d,l,p);break;case"Symbol":c=new a.layer.SymbolLayer(d,l,p);break;case"Tile":c=new a.layer.TileLayer(p,l)}let u=!1;if(c){const a={id:t.id,interopId:t.interopId};c.jsInterop=a,n&&G.getMapContainer(e).events.addLayerEvents(n,c),r.layers.add(c,t.before),u=!0}u?b.logMessage(e,s.Trace,`${i}: layer added:`,c):b.logMessage(e,s.Error,`${i}: layer type '${t.type}' is not supported.`,t)}static removeLayer(e,t){const a=G.getMap(e);if(!a)return;const o=a.layers.getLayerById(t);o&&(a.layers.remove(o),b.logMessage(e,s.Debug,`removeLayer: layer with id '${t}' was removed.`))}static removeLayerAndDataSource(e,t,a){this.removeLayer(e,t.id),R.removeDatasource(e,a.id)}static addMapFeature(e,t,a,s){z.addFeature(e,t,a,s)}static addMapFeatures(e,t,a,s){z.addFeatures(e,t,a,s)}static updateMapFeature(e,t,a){z.updateFeature(e,t,a)}static updateMapFeatures(e,t,a){z.updateFeatures(e,t,a)}}marqdoujAzureMaps=t})();