var marqdoujAzureMaps;(()=>{"use strict";var e={d:(t,a)=>{for(var o in a)e.o(a,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:a[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Configuration:()=>F,Layers:()=>z,MapFactory:()=>V,Maps:()=>$});const a=atlas;var o,n,s,r,i,p,l,u,c,d,v,M,y,h,E,g,f,m,I,S;!function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warn=3]="Warn",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None"}(o||(o={}));class k{static currentLevel=o.Information;static GetMapHeader(e){return`Map with Id '${e}'`}static logMessage(e,t,a,...n){if(t<this.currentLevel)return;const s=`${this.GetMapHeader(e)} ${a}`;switch(t){case o.Trace:console.trace(s,...n);break;case o.Debug:console.debug(s,...n);break;case o.Information:console.info(s,...n);break;case o.Warn:console.warn(s,...n);break;case o.Error:console.error(s,...n);break;case o.Critical:console.error(`CRITICAL: ${s}`,...n)}}}class b{static isEmptyOrNull(e){return null==e||""===e.trim()}static isNotEmptyOrNull(e){return!this.isEmptyOrNull(e)}static isValueInEnum(e,t){return Object.values(e).includes(t)}static isFeature(e){return e&&"Feature"===e.type}static isShape(e){return e&&null!=e.getType}static getFeatureResult(e){return{jsInterop:this.getJsInterop(e),id:e.id?.toString(),type:e.geometry.type,bbox:e.bbox,source:"feature",properties:e.properties}}static getShapeResult(e){return{jsInterop:this.getJsInterop(e),id:e.getId()?.toString(),type:e.getType(),bbox:e.getBounds(),source:"shape",properties:e.getProperties()}}static buildEventResult(e,t,a){return{mapId:e,type:t,payload:a}}static buildShapeResults(e){const t=[];return e.filter(e=>this.isFeature(e)).forEach(e=>{t.push(this.getFeatureResult(e))}),e.filter(e=>this.isShape(e)).forEach(e=>{t.push(this.getShapeResult(e))}),t}static buildMouseEventPayload(e){return{layerId:e.layerId,pixel:e.pixel,position:e.position,shapes:this.buildShapeResults(e.shapes)}}static buildTargetedEventPayload(e){return{jsInterop:e.target.jsInterop,type:e.type}}static buildTouchEventPayload(e){return{pixel:e.pixel,pixels:e.pixels,position:e.position,positions:e.positions,layerId:e.layerId,shapes:this.buildShapeResults(e.shapes)}}static buildWheelEventPayload(e){return{type:e.type}}static isJsInteropDef(e){return e&&null!=e.jsInterop&&null!=e.jsInterop.interopId}static isInteropControl(e,t){let a=this.isJsInteropDef(e);return a&&b.isNotEmptyOrNull(t)&&(a=e.jsInterop.id===t||e.jsInterop.interopId===t),a}static isInteropLayer(e,t){let a=this.isJsInteropDef(e);return a&&b.isNotEmptyOrNull(t)&&(a=e.jsInterop.id===t||e.jsInterop.interopId===t),a}static getJsInterop(e){if(this.isJsInteropDef(e))return e.jsInterop}}class D{static add(e,t){const n=V.getMap(e);n&&t.forEach(t=>{let s=null;switch(t.type.toLowerCase()){case"compass":s=new a.control.CompassControl(t.options);break;case"fullscreen":s=new a.control.FullscreenControl(t.options);break;case"pitch":s=new a.control.PitchControl(t.options);break;case"scale":s=new a.control.ScaleControl(t.options);break;case"style":s=new a.control.StyleControl(t.options);break;case"zoom":s=new a.control.ZoomControl(t.options);break;default:k.logMessage(e,o.Warn,`addControls: control type '${t.type}' is not supported.`)}if(s){const e={id:t.id,interopId:t.interopId,type:t.type};s.jsInterop=e,n.controls.add(s,t.controlOptions)}})}static remove(e,t){const a=V.getMap(e);if(!a)return;const o=a.controls.getControls();t.forEach(t=>{let n=this.#e(o,e,t.interopId);n&&a.controls.remove(n)})}static getControl(e,t){const a=V.getMap(e);if(!a)return;const o=a.controls.getControls();return this.#e(o,e,t)}static getControls(e){const t=V.getMap(e);if(!t)return;const a=t.controls.getControls(),o=[];return a.filter(e=>b.isInteropControl(e)).forEach(e=>{const t=e.jsInterop;t&&o.push(t)}),o}static#e(e,t,a){const n=e.findLast(e=>b.isInteropControl(e,a));return n||k.logMessage(t,o.Debug,`getControl: control not found where id = '${a}'`),n}}class C{mapId;#t;constructor(e){this.mapId=e,this.#t=new U(e)}getMap(){return this.#t.getMap()}getDotNetRef(){return this.#t.getDotNetRef()}}class L{static logEventAdd(e,t,a,n){a?k.logMessage(e,o.Trace,`${t}: event added:`,n):k.logMessage(e,o.Error,`${t}: event not supported:`,n)}static logEventRemoved(e,t,a,n){a?k.logMessage(e,o.Trace,`${t}: event removed:`,n):k.logMessage(e,o.Error,`${t}: event not supported:`,n)}static logInvalidTargetId(e,t,a){k.logMessage(e,o.Error,`${t}: 'once' is not supported:`,a),k.logMessage(e,o.Error,`${t}: invalid TargetId.`,a)}static logOnceNotSupported(e,t,a){k.logMessage(e,o.Error,`${t}: 'once' is not supported:`,a)}}!function(e){e.NotifyMapEvent="NotifyMapEvent",e.NotifyMapEventConfig="NotifyMapEventConfig",e.NotifyMapEventData="NotifyMapEventData",e.NotifyMapEventDataSource="NotifyMapEventDataSource",e.NotifyMapEventError="NotifyMapEventError",e.NotifyMapEventHtmlMarker="NotifyMapEventHtmlMarker",e.NotifyMapEventLayer="NotifyMapEventLayer",e.NotifyMapEventMouse="NotifyMapEventMouse",e.NotifyMapEventPopup="NotifyMapEventPopup",e.NotifyMapEventReady="NotifyMapEventReady",e.NotifyMapEventShape="NotifyMapEventShape",e.NotifyMapEventSource="NotifyMapEventSource",e.NotifyMapEventStyle="NotifyMapEventStyle",e.NotifyMapEventTouch="NotifyMapEventTouch",e.NotifyMapEventWheel="NotifyMapEventWheel",e.NotifyMapReady="NotifyMapReady"}(n||(n={})),function(e){e.Click="click",e.ContextMenu="contextmenu",e.DblClick="dblclick",e.MouseDown="mousedown",e.MouseMove="mousemove",e.MouseOut="mouseout",e.MouseOver="mouseover",e.MouseUp="mouseup"}(s||(s={})),function(e){e.TouchCancel="touchcancel",e.TouchEnd="touchend",e.TouchMove="touchmove",e.TouchStart="touchstart"}(r||(r={})),function(e){e.Wheel="wheel"}(i||(i={}));class _ extends C{constructor(e){super(e)}addEvents(e){0!=e.length&&this.#a(Object.values(e).filter(e=>"map"===e.target))}removeEvents(e){0!=e.length&&this.#o(Object.values(e).filter(e=>"map"===e.target))}#a(e){0!=e.length&&(this.#n(e),this.#s(e),this.#r(e),this.#i(e),this.#p(e),this.#l(e),this.#u(e),this.#c(e))}#o(e){0!=e.length&&(this.#d(e),this.#v(e),this.#M(e),this.#y(e),this.#h(e),this.#E(e),this.#g(e),this.#f(e))}#n(e){if(0==e.length)return;const t=this.getMap(),a="addMapEventConfig";Object.values(e).filter(e=>b.isValueInEnum(p,e.type)).forEach(e=>{let o,n=!1;e.type.toLowerCase()===p.MapConfigChanged&&(o=this.#m),o&&(e.once?L.logOnceNotSupported(this.mapId,a,e):(t.events.add(e.type,o),n=!0)),L.logEventAdd(this.mapId,a,n,e)})}#d(e){if(0==e.length)return;const t=this.getMap();e.forEach(e=>{let a,o=!1;e.type.toLowerCase()===p.MapConfigChanged&&(a=this.#m),a&&(t.events.remove(e.type,a),o=!0),L.logEventRemoved(this.mapId,"removeMapEventConfig",o,e)})}#I=(e,t)=>{let a=b.buildEventResult(this.mapId,t,e);this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventConfig,a)};#m=e=>this.#I(e,p.MapConfigChanged);#s(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>b.isValueInEnum(l,e.type)).forEach(e=>{let a,o=!1;switch(e.type.toLowerCase()){case l.Data:a=this.#S;break;case l.SourceData:a=this.#k;break;case l.StyleData:a=this.#b}a&&(e.once?t.events.addOnce(e.type,a):t.events.add(e.type,a),o=!0),L.logEventAdd(this.mapId,"addMapEventData",o,e)})}#v(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>b.isValueInEnum(l,e.type)).forEach(e=>{let a,o=!1;switch(e.type.toLowerCase()){case l.Data:a=this.#S;break;case l.SourceData:a=this.#k;break;case l.StyleData:a=this.#b}a&&(t.events.remove(e.type,a),o=!0),L.logEventRemoved(this.mapId,"removeMapEventData",o,e)})}#D=(e,t)=>{let a=b.buildEventResult(this.mapId,t,this.#C(e));this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventData,a)};#S=e=>this.#D(e,l.Data);#k=e=>this.#D(e,l.SourceData);#b=e=>this.#D(e,l.StyleData);#C(e){return{dataType:e.dataType,isSourceLoaded:e.isSourceLoaded,source:e.source?.getId(),sourceDataType:e.sourceDataType,tile:e.tile}}#r(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>b.isValueInEnum(u,e.type)).forEach(e=>{e.once?t.events.addOnce(e.type,()=>{this.#L(e.type)}):t.events.add(e.type,()=>{this.#L(e.type)}),L.logEventAdd(this.mapId,"addMapEventGeneral",!0,e)})}#M(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>b.isValueInEnum(u,e.type)).forEach(e=>{t.events.remove(e.type,()=>{}),L.logEventRemoved(this.mapId,"removeMapEventGeneral",!0,e)})}#L=e=>{let t=b.buildEventResult(this.mapId,e,null);this.getDotNetRef().invokeMethodAsync(n.NotifyMapEvent,t)};#i(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>b.isValueInEnum(s,e.type)).forEach(e=>{let a=!1,o=this.#_(e);o&&(e.once?t.events.addOnce(e.type,o):t.events.add(e.type,o),a=!0),L.logEventAdd(this.mapId,"addMapEventMouse",a,e)})}#y(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>b.isValueInEnum(s,e.type)).forEach(e=>{let a=!1,o=this.#_(e);o&&(t.events.remove(e.type,o),a=!0),L.logEventRemoved(this.mapId,"removeMapEventMouse",a,e)})}#_(e){let t;switch(e.type){case s.Click:t=this.#T;break;case s.ContextMenu:t=this.#N;break;case s.DblClick:t=this.#O;break;case s.MouseDown:t=this.#w;break;case s.MouseMove:t=this.#R;break;case s.MouseOut:t=this.#P;break;case s.MouseOver:t=this.#j;break;case s.MouseUp:t=this.#A}return t}#H=(e,t)=>{let a=b.buildMouseEventPayload(e),o=b.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventMouse,o)};#T=e=>this.#H(e,s.Click);#N=e=>this.#H(e,s.ContextMenu);#O=e=>this.#H(e,s.DblClick);#w=e=>this.#H(e,s.MouseDown);#R=e=>this.#H(e,s.MouseMove);#P=e=>this.#H(e,s.MouseOut);#j=e=>this.#H(e,s.MouseOver);#A=e=>this.#H(e,s.MouseUp);#p(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>b.isValueInEnum(c,e.type)).forEach(e=>{let a,o=!1;switch(e.type.toLowerCase()){case c.SourceAdded:a=this.#x;break;case c.SourceRemoved:a=this.#W}a&&(e.once?t.events.addOnce(e.type,a):t.events.add(e.type,a),o=!0),L.logEventAdd(this.mapId,"addMapEventSource",o,e)})}#h(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>b.isValueInEnum(c,e.type)).forEach(e=>{let a,o=!1;switch(e.type.toLowerCase()){case c.SourceAdded:a=this.#x;break;case c.SourceRemoved:a=this.#W}a&&(t.events.remove(e.type,a),o=!0),L.logEventRemoved(this.mapId,"removeMapEventSource",o,e)})}#U(e,t){let a={id:e.getId(),jsInterop:b.getJsInterop(e)},o=b.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventSource,o)}#x=e=>this.#U(e,c.SourceAdded);#W=e=>this.#U(e,c.SourceRemoved);#l(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>b.isValueInEnum(d,e.type)).forEach(e=>{let a=!0;switch(e.type.toLowerCase()){case d.StyleChanged:e.once?t.events.addOnce(d.StyleChanged,this.#$):t.events.add(d.StyleChanged,this.#$);break;case d.StyleImageMissing:e.once?t.events.addOnce(d.StyleImageMissing,this.#V):t.events.add(d.StyleImageMissing,this.#V);break;default:a=!1}L.logEventAdd(this.mapId,"addMapEventStyle",a,e)})}#E(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>b.isValueInEnum(d,e.type)).forEach(e=>{let a=!0;switch(e.type.toLowerCase()){case d.StyleChanged:t.events.remove(e.type,this.#$);break;case d.StyleImageMissing:t.events.remove(e.type,this.#V);break;default:a=!1}L.logEventRemoved(this.mapId,"removeMapEventStyle",a,e)})}#F(e,t){let a={style:e},o=b.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventStyle,o)}#$=e=>this.#F(e.style,d.StyleChanged);#V=e=>this.#F(e,d.StyleImageMissing);#u(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>b.isValueInEnum(r,e.type)).forEach(e=>{let a,o=!1;switch(e.type.toLowerCase()){case r.TouchCancel:a=this.#B;break;case r.TouchEnd:a=this.#z;break;case r.TouchMove:a=this.#G;break;case r.TouchStart:a=this.#K}a&&(e.once?t.events.addOnce(e.type,a):t.events.add(e.type,a),o=!0),L.logEventAdd(this.mapId,"addMapEventTouch",o,e)})}#g(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>b.isValueInEnum(r,e.type)).forEach(e=>{let a,o=!1;switch(e.type.toLowerCase()){case r.TouchCancel:a=this.#B;break;case r.TouchEnd:a=this.#z;break;case r.TouchMove:a=this.#G;break;case r.TouchStart:a=this.#K}a&&(t.events.remove(e.type,a),o=!0),L.logEventRemoved(this.mapId,"removeMapEventTouch",o,e)})}#J=(e,t)=>{let a=b.buildTouchEventPayload(e),o=b.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventTouch,o)};#B=e=>this.#J(e,r.TouchCancel);#z=e=>this.#J(e,r.TouchEnd);#G=e=>this.#J(e,r.TouchMove);#K=e=>this.#J(e,r.TouchStart);#c(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>b.isValueInEnum(i,e.type)).forEach(e=>{let a,o=!1;e.type.toLowerCase()===i.Wheel&&(a=this.#Z),a&&(e.once?t.events.addOnce(e.type,a):t.events.add(e.type,a),o=!0),L.logEventAdd(this.mapId,"addMapEventWheel",o,e)})}#f(e){if(0==e.length)return;const t=this.getMap();Object.values(e).filter(e=>b.isValueInEnum(i,e.type)).forEach(e=>{let a,o=!1;e.type.toLowerCase()===i.Wheel&&(a=this.#Z),a&&(t.events.remove(e.type,a),o=!0),L.logEventRemoved(this.mapId,"removeMapEventWheel",o,e)})}#q=(e,t)=>{let a=b.buildWheelEventPayload(e),o=b.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventWheel,o)};#Z=e=>this.#q(e,i.Wheel)}!function(e){e.MapConfigChanged="mapconfigurationchanged"}(p||(p={})),function(e){e.Data="data",e.SourceData="sourcedata",e.StyleData="styledata"}(l||(l={})),function(e){e.BoxZoomEnd="boxzoomend",e.BoxZoomStart="boxzoomstart",e.Drag="drag",e.DragEnd="dragend",e.DragStart="dragstart",e.Idle="idle",e.Load="load",e.Move="move",e.MoveEnd="moveend",e.MoveStart="movestart",e.Pitch="pitch",e.PitchEnd="pitchend",e.PitchStart="pitchstart",e.Render="render",e.Resize="resize",e.Rotate="rotate",e.RotateEnd="rotateend",e.RotateStart="rotatestart",e.TokenAcquired="tokenacquired",e.Zoom="zoom",e.ZoomEnd="zoomend",e.ZoomStart="zoomstart"}(u||(u={})),function(e){e.SourceAdded="sourceadded",e.SourceRemoved="sourceremoved"}(c||(c={})),function(e){e.StyleChanged="stylechanged",e.StyleImageMissing="styleimagemissing"}(d||(d={}));class T{static add(e,t){const o=V.getMap(e);o&&t.forEach(e=>{let t={...e.options};t.popup&&(t.popup=new a.Popup(t.popup.options));let n=new a.HtmlMarker(t);const s={id:e.id,interopId:e.interopId};n.jsInterop=s,o.markers.add(n),e.togglePopupOnClick&&o.events.add("click",n,()=>{n.togglePopup()})})}static remove(e,t){const a=V.getMap(e);a&&t.forEach(t=>{let o=this.#Q(a,e,t.interopId);o&&a.markers.remove(o)})}static getMarker(e,t){const a=V.getMap(e);if(a)return this.#Q(a,e,t)}static#Q(e,t,a){const n=e.markers.getMarkers().findLast(e=>this.#X(e,a));return n||k.logMessage(t,o.Debug,`getMarker: marker not found where id = '${a}'`),n}static#X(e,t){let a=e&&null!=e.jsInterop&&null!=e.jsInterop.interopId;return a&&b.isNotEmptyOrNull(t)&&(a=e.jsInterop.id===t||e.jsInterop.interopId===t),a}}class N extends C{constructor(e){super(e)}addEvents(e){0!=e.length&&this.#Y(Object.values(e).filter(e=>"htmlmarker"===e.target))}removeEvents(e){0!=e.length&&this.#ee(Object.values(e).filter(e=>"htmlmarker"===e.target))}#Y(e){if(0==e.length)return;const t=this.getMap(),a="addHtmlMarkerEvents";Object.values(e).filter(e=>b.isValueInEnum(v,e.type)).forEach(e=>{const o=this.#te(e);let n=!1;if(o){let s=this.#ae(e);s&&(e.once?t.events.addOnce(e.type,o,s):t.events.add(e.type,o,s),n=!0),L.logEventAdd(this.mapId,a,n,e)}else L.logInvalidTargetId(this.mapId,a,e)})}#ee(e){if(0==e.length)return;const t=this.getMap(),a="removeHtmlMarkerEvents";Object.values(e).filter(e=>b.isValueInEnum(v,e.type)).forEach(e=>{const o=this.#te(e);let n=!1;if(o){let s=this.#ae(e);s&&(t.events.remove(e.type,o,s),n=!0),L.logEventRemoved(this.mapId,a,n,e)}else L.logInvalidTargetId(this.mapId,a,e)})}#ae(e){let t;switch(e.type.toLowerCase()){case v.Click:t=this.#oe;break;case v.ContextMenu:t=this.#ne;break;case v.DblClick:t=this.#se;break;case v.Drag:t=this.#re;break;case v.DragEnd:t=this.#ie;break;case v.DragStart:t=this.#pe;break;case v.KeyDown:t=this.#le;break;case v.KeyPress:t=this.#ue;break;case v.KeyUp:t=this.#ce;break;case v.MouseDown:t=this.#de;break;case v.MouseEnter:t=this.#ve;break;case v.MouseLeave:t=this.#Me;break;case v.MouseMove:t=this.#ye;break;case v.MouseOut:t=this.#he;break;case v.MouseOver:t=this.#Ee;break;case v.MouseUp:t=this.#ge}return t}#te(e){return T.getMarker(this.mapId,e.targetId)}#fe=(e,t)=>{let a=b.buildTargetedEventPayload(e),o=b.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventHtmlMarker,o)};#oe=e=>this.#fe(e,v.Click);#ne=e=>this.#fe(e,v.ContextMenu);#se=e=>this.#fe(e,v.DblClick);#de=e=>this.#fe(e,v.MouseDown);#ve=e=>this.#fe(e,v.MouseEnter);#Me=e=>this.#fe(e,v.MouseLeave);#ye=e=>this.#fe(e,v.MouseMove);#he=e=>this.#fe(e,v.MouseOut);#Ee=e=>this.#fe(e,v.MouseOver);#ge=e=>this.#fe(e,v.MouseUp);#re=e=>this.#fe(e,v.Drag);#ie=e=>this.#fe(e,v.DragEnd);#pe=e=>this.#fe(e,v.DragStart);#le=e=>this.#fe(e,v.KeyDown);#ue=e=>this.#fe(e,v.KeyPress);#ce=e=>this.#fe(e,v.KeyUp)}!function(e){e.Click="click",e.ContextMenu="contextmenu",e.DblClick="dblclick",e.MouseDown="mousedown",e.MouseEnter="mouseenter",e.MouseLeave="mouseleave",e.MouseMove="mousemove",e.MouseOut="mouseout",e.MouseOver="mouseover",e.MouseUp="mouseup",e.Drag="drag",e.DragEnd="dragend",e.DragStart="dragstart",e.KeyDown="keydown",e.KeyPress="keypress",e.KeyUp="keyup"}(v||(v={}));class O{static getDataSourceShapes(e,t){const a=V.getMap(e);if(!a)return;let o=[];const n=this.getDataSource(a,e,t);return n&&(o=b.buildShapeResults(n.getShapes())),o}static clearDatasource(e,t){const a=V.getMap(e);if(!a)return;const n=this.getDataSource(a,e,t);n&&(n.clear(),k.logMessage(e,o.Debug,`- clearDatasource: datasource with ID '${t}' was cleared.`))}static createDatasource(e,t){const n=V.getMap(e);if(!n)return;if(n.sources.getById(t.id))return void k.logMessage(e,o.Warn,`- createDatasource: datasource with ID '${t.id}' already exists.`);const s=new a.source.DataSource(t.id,t.options);n.sources.add(s),t.url&&s.importDataFromUrl(t.url)}static removeDatasource(e,t){const a=V.getMap(e);if(!a)return;const n=a.sources.getById(t);n&&(a.sources.remove(n),k.logMessage(e,o.Debug,`- removeDatasource: datasource with ID '${t}' was removed.`))}static getDataSource(e,t,n){const s=e.sources.getById(n);if(s instanceof a.source.DataSource)return s;k.logMessage(t,o.Debug,`getDataSource: source with ID '${n}' is not a DataSource.`)}}class w extends C{constructor(e){super(e)}addEvents(e){0!=e.length&&this.#me(Object.values(e).filter(e=>"datasource"===e.target))}removeEvents(e){0!=e.length&&this.#Ie(Object.values(e).filter(e=>"datasource"===e.target))}#me(e){if(0==e.length)return;const t=this.getMap(),a="addDataSourceEvents";Object.values(e).filter(e=>b.isValueInEnum(M,e.type)).forEach(e=>{const o=this.#te(t,e);let n=!1;if(o){let s=this.#ae(e);s&&(e.once?t.events.addOnce(e.type,o,s):t.events.add(e.type,o,s),n=!0),L.logEventAdd(this.mapId,a,n,e)}else L.logInvalidTargetId(this.mapId,a,e)})}#Ie(e){if(0==e.length)return;const t=this.getMap(),a="removeDataSourceEvents";Object.values(e).filter(e=>b.isValueInEnum(M,e.type)).forEach(e=>{const o=this.#te(t,e);let n=!1;if(o){let s=this.#ae(e);s&&(t.events.remove(e.type,o,s),n=!0),L.logEventRemoved(this.mapId,a,n,e)}else L.logInvalidTargetId(this.mapId,a,e)})}#ae(e){let t;switch(e.type.toLowerCase()){case M.DataSourceUpdated:t=this.#Se;break;case M.DataAdded:t=this.#ke;break;case M.DataRemoved:t=this.#be}return t}#te(e,t){return O.getDataSource(e,this.mapId,t.targetId)}#Se=(e,t)=>{let a={sourceId:e.getId()},o=b.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventDataSource,o)};#De=e=>this.#Se(e,M.DataSourceUpdated);#Ce=(e,t)=>{let a={shapes:b.buildShapeResults(e)},o=b.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventDataSource,o)};#ke=e=>this.#Ce(e,M.DataAdded);#be=e=>this.#Ce(e,M.DataRemoved)}!function(e){e.DataSourceUpdated="datasourceupdated",e.DataAdded="dataadded",e.DataRemoved="dataremoved"}(M||(M={}));class R extends C{constructor(e){super(e)}addEvents(e){0!=e.length&&this.#Le(Object.values(e).filter(e=>"stylecontrol"===e.target))}removeEvents(e){0!=e.length&&this.#_e(Object.values(e).filter(e=>"stylecontrol"===e.target))}#Le(e){if(0==e.length)return;const t=this.getMap(),a="addStyleControlEvents";Object.values(e).filter(e=>b.isValueInEnum(y,e.type)).forEach(e=>{const o=D.getControl(this.mapId,e.targetId);if(o){let n,s=!1;e.type.toLowerCase()===y.StyleSelected&&(n=this.#Te),n&&(e.once?t.events.addOnce(e.type,o,n):t.events.add(e.type,o,n),s=!0),L.logEventAdd(this.mapId,a,s,e)}else L.logInvalidTargetId(this.mapId,a,e)})}#_e(e){if(0==e.length)return;const t=this.getMap(),a="removeStyleControlEvents";Object.values(e).filter(e=>b.isValueInEnum(y,e.type)).forEach(e=>{const o=D.getControl(this.mapId,e.targetId);if(o){let n,s=!1;e.type.toLowerCase()===y.StyleSelected&&(n=this.#Te),n&&(t.events.remove(e.type,o,n),s=!0),L.logEventRemoved(this.mapId,a,s,e)}else L.logInvalidTargetId(this.mapId,a,e)})}#Ne=(e,t)=>{let a=b.buildEventResult(this.mapId,t,{style:e});this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventStyle,a)};#Te=e=>this.#Ne(e,y.StyleSelected)}!function(e){e.StyleSelected="styleselected"}(y||(y={}));class P extends C{constructor(e){super(e)}addEvents(e){0!=e.length&&this.#Oe(Object.values(e).filter(e=>("layer"===e.target||"map"===e.target)&&b.isValueInEnum(E,e.type)))}removeEvents(e){0!=e.length&&this.#we(Object.values(e).filter(e=>("layer"===e.target||"map"===e.target)&&b.isValueInEnum(E,e.type)))}#Oe(e){if(0==e.length)return;const t=this.getMap(),a="addLayerEvents";e.forEach(e=>{let o=!1,n=this.#ae(e);if(n)if("layer"===e.target){const s=this.#te(t,e);s?(e.once?t.events.addOnce(e.type,s,n):t.events.add(e.type,s,n),o=!0):L.logInvalidTargetId(this.mapId,a,e)}else e.once?t.events.addOnce(e.type,n):t.events.add(e.type,n),o=!0;L.logEventAdd(this.mapId,a,o,e)})}#we(e){if(0==e.length)return;const t=this.getMap(),a="removeLayerEvents";e.forEach(e=>{let o=!1,n=this.#ae(e);if(n)if("layer"===e.target){const s=this.#te(t,e);s?(t.events.remove(e.type,s,n),o=!0):L.logInvalidTargetId(this.mapId,a,e)}else t.events.remove(e.type,n),o=!0;L.logEventRemoved(this.mapId,a,o,e)})}#te(e,t){if("layer"===t.target)return e.layers.getLayerById(t.targetId)}#ae(e){let t;const a="layer"===e.target;switch(e.type){case E.LayerAdded:t=a?this.#Re:this.#Pe;break;case E.LayerRemoved:t=a?this.#je:this.#Ae;break;case E.Click:t=this.#He;break;case E.ContextMenu:t=this.#xe;break;case E.DblClick:t=this.#We;break;case E.MouseDown:t=this.#Ue;break;case E.MouseEnter:t=this.#$e;break;case E.MouseLeave:t=this.#Ve;break;case E.MouseMove:t=this.#Fe;break;case E.MouseOut:t=this.#Be;break;case E.MouseOver:t=this.#ze;break;case E.MouseUp:t=this.#Ge;break;case E.TouchCancel:t=this.#Ke;break;case E.TouchEnd:t=this.#Je;break;case E.TouchMove:t=this.#Ze;break;case E.TouchStart:t=this.#qe;break;case E.Wheel:t=this.#Qe}return t}#Xe=(e,t,a)=>{let o={id:e.getId(),jsInterop:b.getJsInterop(e)},s=b.buildEventResult(this.mapId,t,o),r=a?n.NotifyMapEventLayer:n.NotifyMapEvent;this.getDotNetRef().invokeMethodAsync(r,s)};#Re=e=>this.#Xe(e,h.LayerAdded,!0);#je=e=>this.#Xe(e,h.LayerRemoved,!0);#Pe=e=>this.#Xe(e,h.LayerAdded,!1);#Ae=e=>this.#Xe(e,h.LayerRemoved,!1);#Ye=(e,t)=>{let a={id:e.layerId,touch:b.buildTouchEventPayload(e)},o=b.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventLayer,o)};#Ke=e=>this.#Ye(e,r.TouchCancel);#Je=e=>this.#Ye(e,r.TouchEnd);#Ze=e=>this.#Ye(e,r.TouchMove);#qe=e=>this.#Ye(e,r.TouchStart);#et=(e,t)=>{let a={id:e.layerId,mouse:b.buildMouseEventPayload(e)},o=b.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventLayer,o)};#He=e=>this.#et(e,s.Click);#xe=e=>this.#et(e,s.ContextMenu);#We=e=>this.#et(e,s.DblClick);#Ue=e=>this.#et(e,s.MouseDown);#$e=e=>this.#et(e,g.MouseEnter);#Ve=e=>this.#et(e,g.MouseLeave);#Fe=e=>this.#et(e,s.MouseMove);#Be=e=>this.#et(e,s.MouseOut);#ze=e=>this.#et(e,s.MouseOver);#Ge=e=>this.#et(e,s.MouseUp);#tt=(e,t)=>{let a={wheel:b.buildWheelEventPayload(e)},o=b.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventLayer,o)};#Qe=e=>this.#tt(e,E.Wheel)}!function(e){e.LayerAdded="layeradded",e.LayerRemoved="layerremoved"}(h||(h={})),function(e){e.LayerAdded="layeradded",e.LayerRemoved="layerremoved",e.Click="click",e.ContextMenu="contextmenu",e.DblClick="dblclick",e.MouseDown="mousedown",e.MouseEnter="mouseenter",e.MouseLeave="mouseleave",e.MouseMove="mousemove",e.MouseOut="mouseout",e.MouseOver="mouseover",e.MouseUp="mouseup",e.TouchCancel="touchcancel",e.TouchEnd="touchend",e.TouchMove="touchmove",e.TouchStart="touchstart",e.Wheel="wheel"}(E||(E={})),function(e){e.MouseEnter="mouseenter",e.MouseLeave="mouseleave"}(g||(g={}));class j extends C{constructor(e){super(e)}addEvents(e){0!=e.length&&this.#at(Object.values(e).filter(e=>"shape"===e.target))}removeEvents(e){0!=e.length&&this.#ot(Object.values(e).filter(e=>"shape"===e.target))}#at(e){if(0==e.length)return;const t=this.getMap(),a="addShapeEvents";Object.values(e).filter(e=>b.isValueInEnum(f,e.type)).forEach(e=>{const o=this.#te(t,e);let n=!1;if(o){let s=this.#ae(e);s&&(e.once?t.events.addOnce(e.type,o,s):t.events.add(e.type,o,s),n=!0),L.logEventAdd(this.mapId,a,n,e)}else L.logInvalidTargetId(this.mapId,a,e)})}#ot(e){if(0==e.length)return;const t=this.getMap(),a="removeShapeEvents";Object.values(e).filter(e=>b.isValueInEnum(f,e.type)).forEach(e=>{const o=this.#te(t,e);let n=!1;if(o){let s=this.#ae(e);s&&(t.events.remove(e.type,o,s),n=!0),L.logEventRemoved(this.mapId,a,n,e)}else L.logInvalidTargetId(this.mapId,a,e)})}#ae(e){let t;return e.type.toLowerCase()===f.ShapeChanged&&(t=this.#nt),t}#te(e,t){return e.sources.getById(t.targetSourceId).getShapeById(t.targetId)}#st=(e,t)=>{let a=b.getShapeResult(e),o=b.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventShape,o)};#nt=e=>this.#st(e,f.ShapeChanged)}!function(e){e.ShapeChanged="shapechanged"}(f||(f={}));class A{static add(e,t){const o=V.getMap(e);o&&t.forEach(e=>{let t=new a.Popup(e.options);const n={id:e.id,interopId:e.interopId};t.jsInterop=n,o.popups.add(t)})}static remove(e,t){const a=V.getMap(e);a&&t.forEach(t=>{let o=this.#rt(a,e,t.interopId);o&&a.popups.remove(o)})}static getPopup(e,t){const a=V.getMap(e);if(a)return this.#rt(a,e,t)}static#rt(e,t,a){const n=e.popups.getPopups().findLast(e=>this.#it(e,a));return n||k.logMessage(t,o.Debug,`getPopup: popup not found where id = '${a}'`),n}static#it(e,t){let a=e&&null!=e.jsInterop&&null!=e.jsInterop.interopId;return a&&b.isNotEmptyOrNull(t)&&(a=e.jsInterop.id===t||e.jsInterop.interopId===t),a}}class H extends C{constructor(e){super(e)}addEvents(e){0!=e.length&&this.#pt(Object.values(e).filter(e=>"popup"===e.target))}removeEvents(e){0!=e.length&&this.#lt(Object.values(e).filter(e=>"popup"===e.target))}#pt(e){if(0==e.length)return;const t=this.getMap(),a="addPopupEvents";Object.values(e).filter(e=>b.isValueInEnum(m,e.type)).forEach(e=>{const o=this.#te(e);let n=!1;if(o){let s=this.#ae(e);s&&(e.once?t.events.addOnce(e.type,o,s):t.events.add(e.type,o,s),n=!0),L.logEventAdd(this.mapId,a,n,e)}else L.logInvalidTargetId(this.mapId,a,e)})}#lt(e){if(0==e.length)return;const t=this.getMap(),a="removePopupEvents";Object.values(e).filter(e=>b.isValueInEnum(m,e.type)).forEach(e=>{const o=this.#te(e);let n=!1;if(o){let s=this.#ae(e);s&&(t.events.remove(e.type,o,s),n=!0),L.logEventRemoved(this.mapId,a,n,e)}else L.logInvalidTargetId(this.mapId,a,e)})}#ae(e){let t;switch(e.type.toLowerCase()){case m.Close:t=this.#ut;break;case m.Drag:t=this.#ct;break;case m.DragEnd:t=this.#dt;break;case m.DragStart:t=this.#vt;break;case m.Open:t=this.#Mt}return t}#te(e){return A.getPopup(this.mapId,e.targetId)}#yt=(e,t)=>{let a=b.buildTargetedEventPayload(e),o=b.buildEventResult(this.mapId,t,a);this.getDotNetRef().invokeMethodAsync(n.NotifyMapEventPopup,o)};#ut=e=>this.#yt(e,m.Close);#ct=e=>this.#yt(e,m.Drag);#dt=e=>this.#yt(e,m.DragEnd);#vt=e=>this.#yt(e,m.DragStart);#Mt=e=>this.#yt(e,m.Open)}!function(e){e.Drag="drag",e.DragEnd="dragend",e.DragStart="dragstart",e.Open="open",e.Close="close"}(m||(m={}));class x extends C{mapEvents;markerEvents;sourceEvents;styleControlEvents;layerEvents;shapeEvents;popupEvents;constructor(e){super(e),this.mapEvents=new _(e),this.markerEvents=new N(e),this.sourceEvents=new w(e),this.styleControlEvents=new R(e),this.layerEvents=new P(e),this.shapeEvents=new j(e),this.popupEvents=new H(e)}addEvents(e){0!=e.length&&(this.mapEvents.addEvents(e),this.markerEvents.addEvents(e),this.sourceEvents.addEvents(e),this.styleControlEvents.addEvents(e),this.layerEvents.addEvents(e),this.shapeEvents.addEvents(e),this.popupEvents.addEvents(e))}removeEvents(e){0!=e.length&&(this.mapEvents.removeEvents(e),this.markerEvents.removeEvents(e),this.sourceEvents.removeEvents(e),this.styleControlEvents.removeEvents(e),this.layerEvents.removeEvents(e),this.shapeEvents.removeEvents(e),this.popupEvents.removeEvents(e))}}class W{dotNetRef;mapId;azMap;events;constructor(e,t,a){this.dotNetRef=e,this.mapId=t,this.azMap=a,this.events=new x(t)}clear(){this.dotNetRef=null,this.mapId=null,this.azMap=null}}class U{mapId;constructor(e){this.mapId=e}getContainer(){return V.getMapContainer(this.mapId)}getMap(){return this.getContainer().azMap}getDotNetRef(){return this.getContainer().dotNetRef}}class ${static addEvents(e,t){V.getMapContainer(e).events.addEvents(t)}static removeEvents(e,t){V.getMapContainer(e).events.removeEvents(t)}static addControls(e,t){D.add(e,t)}static getControls(e){return D.getControls(e)}static removeControls(e,t){D.remove(e,t)}static clearDatasource(e,t){O.clearDatasource(e,t)}static createDatasource(e,t){O.createDatasource(e,t)}static getDataSourceShapes(e,t){return O.getDataSourceShapes(e,t)}static removeDatasource(e,t){O.removeDatasource(e,t)}static addMarkers(e,t){T.add(e,t)}static removeMarkers(e,t){T.remove(e,t)}static addPopups(e,t){A.add(e,t)}static removePopups(e,t){A.remove(e,t)}}class V{static#ht=new Map;static getAuthTokenCallback;static createMap(e,t,n,s,r){if(k.currentLevel=n.logLevel??o.Information,this.#ht.has(t))return void k.logMessage(t,o.Warn,"Map already exists.");const i=this.#Et(n.authOptions,n.options),p=new a.Map(t,i);this.#ht.set(t,new W(e,t,p)),k.logMessage(t,o.Debug,"was created."),r&&D.add(t,r),this.#gt(e,t,s)}static getMap(e){const t=this.getMapContainer(e);return t?.azMap}static getMapContainer(e){const t=this.#ht.get(e);return t||k.logMessage(e,o.Debug,"mapContainer was not found."),t}static removeMap(e){const t=this.#ht.get(e);t&&this.#ht.delete(e)&&(t.clear(),k.logMessage(e,o.Debug,"was removed"))}static#Et(e,t){let a={};return t&&(t.camera?a={...a,...t.camera}:t.cameraBounds&&(a={...a,...t.cameraBounds}),t.service&&(a={...a,...t.service}),t.style&&(a={...a,...t.style}),t.userInteraction&&(a={...a,...t.userInteraction})),a.authOptions=e,a.authOptions.getToken=this.getAuthTokenCallback,a}static#gt(e,t,a){const s=this.getMap(t);s?(a??=[],s.events.addOnce(I.Ready,r=>{s.events.add(I.Error,a=>{const s={message:a.error.message,name:a.error.name,stack:a.error.stack,cause:a.error.cause};let r=b.buildEventResult(t,I.Ready,s);k.logMessage(t,o.Error,"Map error",r),e.invokeMethodAsync(n.NotifyMapEventError,r)}),$.addEvents(t,a);let i=b.buildEventResult(t,I.Ready,null);e.invokeMethodAsync(n.NotifyMapEventReady,i),e.invokeMethodAsync(n.NotifyMapReady,i)})):k.logMessage(t,o.Error,"Cannot build events. Map not found.")}}!function(e){e.Error="error",e.Ready="ready"}(I||(I={}));class F{static getCamera(e){const t=V.getMap(e);if(t)return t.getCamera()}static setCamera(e,t){const a=V.getMap(e);if(!a)return;let o=this.#ft(t);a.setCamera(o)}static getMapOptions(e){const t=V.getMap(e);if(t)return{mapCamera:t.getCamera(),service:t.getServiceOptions(),style:t.getStyle(),userInteraction:t.getUserInteraction()}}static setMapOptions(e,t){const a=V.getMap(e);if(!a)return;let o=this.#ft(t.camera);a.setCamera(o),t.service&&a.setServiceOptions(t.service),t.style&&a.setStyle(t.style),t.userInteraction&&a.setUserInteraction(t.userInteraction)}static getServiceOptions(e){const t=V.getMap(e);if(t)return t.getServiceOptions()}static setServiceOptions(e,t){const a=V.getMap(e);a&&a.setServiceOptions(t)}static getStyle(e){const t=V.getMap(e);if(t)return t.getStyle()}static setStyle(e,t){const a=V.getMap(e);a&&a.setStyle(t)}static getUserInteraction(e){const t=V.getMap(e);if(t)return t.getUserInteraction()}static setUserInteraction(e,t){const a=V.getMap(e);a&&a.setUserInteraction(t)}static#ft(e){let t={};return e.camera?t={...e.camera,...e.animation}:e.cameraBounds&&(t={...e.cameraBounds,...e.animation}),t}}class B{static addFeature(e,t,a,o){const n=V.getMap(e);if(!n)return;const s=O.getDataSource(n,e,a);s&&this.#mt(n,e,t,s,o)}static addFeatures(e,t,a,o){const n=V.getMap(e);if(!n)return;const s=O.getDataSource(n,e,a);s&&t.forEach(t=>{this.#mt(n,e,t,s,o)})}static#mt(e,t,n,s,r){if(r&&n.id){const e=s.getShapeById(n.id);e&&s.remove(e)}let i;switch(n.geometry.type.toLowerCase()){case S.Point:i=new a.data.Point(n.geometry.coordinates);break;case S.MultiPoint:i=new a.data.MultiPoint(n.geometry.coordinates,n.bbox);break;case S.LineString:i=new a.data.LineString(n.geometry.coordinates,n.bbox);break;case S.Polygon:i=new a.data.Polygon(n.geometry.coordinates,n.bbox)}if(!i)return void k.logMessage(t,o.Error,`adding feature error: geometry type '${n.geometry.type}' not supported`);const p={id:n.id,interopId:n.interopId},l={...n.properties,jsInterop:p};let u=new a.data.Feature(i,l,n.id);if(n.asShape){let e=new a.Shape(u);s.add(e)}else s.add(u)}static updateFeature(e,t,a){const o=V.getMap(e);if(!o)return;const n=O.getDataSource(o,e,a);if(!n)return;const s=n.getShapeById(t.id);s&&s.setCoordinates(t.geometry.coordinates)}static updateFeatures(e,t,a){const o=V.getMap(e);if(!o)return;const n=O.getDataSource(o,e,a);n&&t.forEach(e=>{const t=n.getShapeById(e.id);t&&t.setCoordinates(e.geometry.coordinates)})}}!function(e){e.Point="point",e.MultiPoint="multipoint",e.LineString="linestring",e.MultiLineString="multilinestring",e.Polygon="polygon",e.MultiPolygon="multipolygon"}(S||(S={}));class z{static createLayer(e,t,n){const s=V.getMap(e);if(!s)return;const r="createLayer";if(b.isEmptyOrNull(t.type))return void k.logMessage(e,o.Error,`${r}: layer type is missing`);const i=t.id;if(b.isNotEmptyOrNull(i)&&s.layers.getLayerById(i))return void k.logMessage(e,o.Error,`${r}: layer already exists where ID=${i}`);let p,l;if(n){if(p=new a.source.DataSource(n.id,n.options),!p)return void k.logMessage(e,o.Error,`${r}: Unable to create datasource.`,n);s.sources.add(p),b.isNotEmptyOrNull(n.url)&&p.importDataFromUrl(n.url)}else if(p=s.sources.getById(t.sourceId),!p)return void k.logMessage(e,o.Error,`${r}: Unable to find datasource where ID=${t.sourceId}.`);const u=t.options||{};switch(t.type){case"Bubble":l=new a.layer.BubbleLayer(p,i,u);break;case"HeatMap":l=new a.layer.HeatMapLayer(p,i,u);break;case"Image":l=new a.layer.ImageLayer(u,i);break;case"Line":l=new a.layer.LineLayer(p,i,u);break;case"Polygon":l=new a.layer.PolygonLayer(p,i,u);break;case"PolygonExtrusion":l=new a.layer.PolygonExtrusionLayer(p,i,u);break;case"Symbol":l=new a.layer.SymbolLayer(p,i,u);break;case"Tile":l=new a.layer.TileLayer(u,i)}let c=!1;if(l){const e={id:t.id,interopId:t.interopId};l.jsInterop=e,s.layers.add(l,t.before),c=!0}c?k.logMessage(e,o.Trace,`${r}: layer added:`,l):k.logMessage(e,o.Error,`${r}: layer type '${t.type}' is not supported.`,t)}static removeLayer(e,t){const a=V.getMap(e);if(!a)return;const n=a.layers.getLayerById(t);n&&(a.layers.remove(n),k.logMessage(e,o.Debug,`removeLayer: layer with id '${t}' was removed.`))}static removeLayerAndDataSource(e,t,a){this.removeLayer(e,t.id),O.removeDatasource(e,a.id)}static addMapFeature(e,t,a,o){B.addFeature(e,t,a,o)}static addMapFeatures(e,t,a,o){B.addFeatures(e,t,a,o)}static updateMapFeature(e,t,a){B.updateFeature(e,t,a)}static updateMapFeatures(e,t,a){B.updateFeatures(e,t,a)}}marqdoujAzureMaps=t})();